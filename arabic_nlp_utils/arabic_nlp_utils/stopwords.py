"""
arabic_nlp_utils.stopwords
============================
قائمة كلمات التوقف العربية وأدوات تصفيتها.

Arabic stopwords list and filtering utilities.
"""

# ───────── Comprehensive Arabic Stopwords ─────────

STOPWORDS = {
    # حروف الجر
    'في', 'من', 'إلى', 'على', 'عن', 'مع', 'حتى', 'منذ', 'خلال',
    'بين', 'فوق', 'تحت', 'أمام', 'وراء', 'خلف', 'حول', 'عند',
    'لدى', 'نحو', 'ضد', 'عبر', 'دون',
    # حروف العطف
    'و', 'أو', 'ثم', 'لكن', 'بل', 'لا', 'أم',
    # ضمائر
    'أنا', 'أنت', 'أنتِ', 'هو', 'هي', 'نحن', 'أنتم', 'أنتن',
    'هم', 'هن', 'هذا', 'هذه', 'هؤلاء', 'ذلك', 'تلك', 'أولئك',
    'الذي', 'التي', 'الذين', 'اللذان', 'اللتان', 'اللواتي',
    # أدوات التعريف والنكرة
    'ال', 'ال',
    # أفعال مساعدة وناقصة
    'كان', 'كانت', 'كانوا', 'يكون', 'تكون', 'يكونون',
    'ليس', 'ليست', 'ليسوا',
    'أصبح', 'أصبحت', 'صار', 'صارت',
    'ظل', 'ظلت', 'بات', 'باتت',
    'ما', 'لا', 'لم', 'لن', 'قد',
    # أدوات الاستفهام
    'من', 'ما', 'ماذا', 'متى', 'أين', 'كيف', 'لماذا', 'كم', 'هل', 'أ',
    # أدوات النصب والجزم
    'أن', 'لن', 'كي', 'حتى', 'إذن',
    'لم', 'لما', 'لام',
    # حروف النداء
    'يا', 'أي', 'أيها', 'أيتها',
    # إن وأخواتها
    'إن', 'أن', 'كأن', 'لكن', 'ليت', 'لعل',
    # ظروف الزمان والمكان
    'الآن', 'اليوم', 'غداً', 'أمس', 'بعد', 'قبل',
    'هنا', 'هناك', 'حيث', 'أينما', 'حيثما',
    'فيها', 'منها', 'عليها', 'إليها',
    'فيه', 'منه', 'عليه', 'إليه',
    # كلمات شائعة
    'كل', 'بعض', 'كلا', 'كلتا', 'جميع', 'عدة', 'سائر',
    'غير', 'سوى', 'مثل', 'نفس', 'ذات', 'عين',
    'كذلك', 'أيضاً', 'كما', 'إذا', 'إذ', 'إذن', 'لو', 'لولا',
    'حين', 'حينما', 'عندما', 'بينما', 'مذ',
    'ربما', 'سوف', 'سـ', 'فإن', 'لأن', 'إلا',
    'فقط', 'تقريباً', 'أكثر', 'أقل', 'أفضل', 'أحسن',
    'بسبب', 'بفضل', 'رغم', 'حسب', 'وفق',
    'كان', 'قال', 'يقول', 'كانت',
    'أحد', 'واحد', 'أول', 'آخر', 'ثاني',
    'خاصة', 'خاصةً', 'عامة', 'عامةً',
    'عام', 'سنة', 'يوم', 'شهر',
    # ضمائر متصلة (كلمات مع ضمائر)
    'به', 'بها', 'لها', 'له', 'لهم', 'لهن', 'لنا', 'لكم', 'لك',
    'منهم', 'منهن', 'فيهم', 'عنهم', 'عنها', 'معهم', 'معها',
    'بهم', 'بهن', 'إليهم', 'عليهم', 'لديه', 'لديها', 'لديهم',
    # كلمات إضافية
    'تم', 'يتم', 'وقد', 'وقف', 'أما', 'بعد',
    'ثم', 'حيث', 'وإن', 'وهو', 'وهي', 'وهم',
    'ذلك', 'هذا', 'هذه', 'تلك', 'تلكم',
    'ولا', 'ولم', 'ولن', 'ولكن',
    'بأن', 'فإن', 'لأن', 'مما', 'ممن', 'إذ',
    'وكان', 'وكانت', 'فكان', 'فكانت',
    'وقال', 'فقال', 'قالت',
    'ما', 'لما', 'مما', 'إنما', 'بينما', 'كلما', 'حيثما',
    'عما', 'فيما', 'بما',
    'حول', 'كل', 'لكل', 'بكل',
    'ولكنه', 'ولكنها', 'لذلك', 'وكذلك', 'هكذا',
}


def is_stopword(word: str) -> bool:
    """
    فحص هل الكلمة من كلمات التوقف.

    Check if a word is a stopword.

    >>> is_stopword("في")
    True
    >>> is_stopword("كتاب")
    False
    """
    return word.strip() in STOPWORDS


def remove_stopwords(text: str) -> str:
    """
    إزالة كلمات التوقف من النص.

    Remove stopwords from text.

    >>> remove_stopwords("أنا ذهبت إلى المدرسة في الصباح")
    'ذهبت المدرسة الصباح'
    """
    words = text.split()
    filtered = [w for w in words if w not in STOPWORDS]
    return ' '.join(filtered)


def filter_stopwords(words: list) -> list:
    """
    تصفية كلمات التوقف من قائمة كلمات.

    Filter stopwords from a list of words.

    >>> filter_stopwords(["أنا", "أحب", "اللغة", "العربية"])
    ['أحب', 'اللغة', 'العربية']
    """
    return [w for w in words if w not in STOPWORDS]


def get_stopwords() -> set:
    """
    الحصول على نسخة من قائمة كلمات التوقف.

    Get a copy of the stopwords set.

    >>> len(get_stopwords()) > 100
    True
    """
    return STOPWORDS.copy()


def add_stopwords(words: set) -> None:
    """
    إضافة كلمات جديدة لقائمة التوقف.

    Add new words to the stopwords set.

    >>> add_stopwords({"كلمة_جديدة"})
    >>> is_stopword("كلمة_جديدة")
    True
    """
    STOPWORDS.update(words)


def remove_from_stopwords(words: set) -> None:
    """
    إزالة كلمات من قائمة التوقف.

    Remove words from the stopwords set.
    """
    STOPWORDS.difference_update(words)


def stopword_count(text: str) -> int:
    """
    عد كلمات التوقف في النص.

    Count stopwords in text.

    >>> stopword_count("أنا ذهبت إلى المدرسة في الصباح")
    3
    """
    words = text.split()
    return sum(1 for w in words if w in STOPWORDS)


def stopword_ratio(text: str) -> float:
    """
    نسبة كلمات التوقف في النص.

    Calculate the ratio of stopwords in text.

    >>> ratio = stopword_ratio("أنا ذهبت إلى المدرسة")
    >>> 0.0 <= ratio <= 1.0
    True
    """
    words = text.split()
    if not words:
        return 0.0
    return stopword_count(text) / len(words)
